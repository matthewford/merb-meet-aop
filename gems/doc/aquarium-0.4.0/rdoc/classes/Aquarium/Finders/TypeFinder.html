<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Aquarium::Finders::TypeFinder</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Aquarium::Finders::TypeFinder</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/aquarium/finders/type_finder_rb.html">
                lib/aquarium/finders/type_finder.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000036">add_ancestors</a>&nbsp;&nbsp;
      <a href="#M000035">add_descendents</a>&nbsp;&nbsp;
      <a href="#M000042">empty</a>&nbsp;&nbsp;
      <a href="#M000025">find</a>&nbsp;&nbsp;
      <a href="#M000030">find_by_name</a>&nbsp;&nbsp;
      <a href="#M000028">find_matching</a>&nbsp;&nbsp;
      <a href="#M000029">find_namespace_matched</a>&nbsp;&nbsp;
      <a href="#M000031">find_next_types</a>&nbsp;&nbsp;
      <a href="#M000032">finish_and_make_successful_result</a>&nbsp;&nbsp;
      <a href="#M000034">handle_ancestors_and_descendents</a>&nbsp;&nbsp;
      <a href="#M000026">handle_errors</a>&nbsp;&nbsp;
      <a href="#M000027">is_recognized_option</a>&nbsp;&nbsp;
      <a href="#M000033">make_failed_result</a>&nbsp;&nbsp;
      <a href="#M000039">make_return_hash</a>&nbsp;&nbsp;
      <a href="#M000040">prettify</a>&nbsp;&nbsp;
      <a href="#M000038">should_find_ancestors</a>&nbsp;&nbsp;
      <a href="#M000037">should_find_descendents</a>&nbsp;&nbsp;
      <a href="#M000041">strip</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="../Utils/ArrayUtils.html">Aquarium::Utils::ArrayUtils</a></span>
        <span class="include-name"><a href="../Utils/TypeUtils.html">Aquarium::Utils::TypeUtils</a></span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TYPES_SYNONYMS</td>
          <td>=</td>
          <td class="context-item-value">%w[name names type types]</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Protected Class methods</h3>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">is_recognized_option</span><span class="method-args">(option_or_symbol)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 131</span>
131:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">is_recognized_option</span> <span class="ruby-identifier">option_or_symbol</span>
132:         <span class="ruby-constant">TYPES_SYNONYMS</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
133:           [<span class="ruby-value str">''</span>, <span class="ruby-value str">&quot;exclude_&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">excl</span><span class="ruby-operator">|</span> 
134:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> [<span class="ruby-node">&quot;#{excl}#{t}&quot;</span>, <span class="ruby-node">&quot;#{excl}#{t}_and_descendents&quot;</span>, <span class="ruby-node">&quot;#{excl}#{t}_and_ancestors&quot;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">option_or_symbol</span>.<span class="ruby-identifier">to_s</span>)
135:           <span class="ruby-keyword kw">end</span>
136:         <span class="ruby-keyword kw">end</span>
137:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">option_or_symbol</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;noop&quot;</span>)
138:         <span class="ruby-keyword kw">false</span>
139:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="#M000025" class="method-signature">
          <span class="method-name">find</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Usage:
</p>
<pre>
 finder_result = TypeFinder.new.find [options =&gt; [...] ]
</pre>
<p>
where <tt>:types =&gt; types_and_type_names_and_regexps</tt>:: <tt>:names
=&gt; types_and_type_names_and_regexps</tt>:: <tt>:type =&gt;
types_and_type_names_and_regexps</tt>::
</p>
<table>
<tr><td valign="top"><tt>:name  =&gt; types_and_type_names_and_regexps</tt>:</td><td>A single type or array of types, specified using any combination of the
type name strings, the type &quot;constants&quot; and/or regular
expessions. The four different flags are just &quot;sugar&quot; for each
other.

</td></tr>
</table>
<p>
<tt>:types_and_descendents =&gt; types_and_type_names_and_regexps</tt>::
<tt>:names_and_descendents =&gt; types_and_type_names_and_regexps</tt>::
<tt>:type_and_descendents =&gt; types_and_type_names_and_regexps</tt>::
<tt>:name_and_descendents =&gt; types_and_type_names_and_regexps</tt>::
</p>
<p>
Same as for <tt>:types</tt> <em>etc.</em>, but also match their
descendents.
</p>
<p>
<tt>:types_and_ancestors =&gt; types_and_type_names_and_regexps</tt>::
<tt>:names_and_ancestors =&gt; types_and_type_names_and_regexps</tt>::
<tt>:type_and_ancestors =&gt; types_and_type_names_and_regexps</tt>::
<tt>:name_and_ancestors =&gt; types_and_type_names_and_regexps</tt>::
</p>
<p>
Same as for <tt>:types</tt> <em>etc.</em>, but also match their ancestors.
This option will also match <tt>Class</tt>, <tt>Module</tt>,
&lt;i&gt;etc.&lt;/&gt;, so use with caution!
</p>
<p>
To get both descendents and ancestors, use both options with the same type
specification.
</p>
<p>
The &quot;other options&quot; include the following:
</p>
<p>
<tt>:exclude_type =&gt; types_and_type_names_and_regexps</tt>::
<tt>:exclude_types =&gt; types_and_type_names_and_regexps</tt>::
<tt>:exclude_name =&gt; types_and_type_names_and_regexps</tt>::
</p>
<table>
<tr><td valign="top"><tt>:exclude_names =&gt; types_and_type_names_and_regexps</tt>:</td><td>Exclude the specified type or list of types from the list of matched types.
These excluded types <b>won&#8216;t</b> appear in the
FinderResult#not_matched.

</td></tr>
</table>
<p>
<tt>:exclude_types_and_descendents =&gt;
types_and_type_names_and_regexps</tt>:: <tt>:exclude_names_and_descendents
=&gt; types_and_type_names_and_regexps</tt>::
<tt>:exclude_type_and_descendents =&gt;
types_and_type_names_and_regexps</tt>:: <tt>:exclude_name_and_descendents
=&gt; types_and_type_names_and_regexps</tt>::
</p>
<p>
<tt>:exclude_types_and_ancestors =&gt;
types_and_type_names_and_regexps</tt>:: <tt>:exclude_names_and_ancestors
=&gt; types_and_type_names_and_regexps</tt>::
<tt>:exclude_type_and_ancestors =&gt;
types_and_type_names_and_regexps</tt>:: <tt>:exclude_name_and_ancestors
=&gt; types_and_type_names_and_regexps</tt>::
</p>
<p>
Exclude the descendents or ancestors, as well.
</p>
<p>
Because of the special sigificance of the module (&quot;namespace&quot;)
separator &quot;::&quot;, the rules for the regular expressions are as
follows. Assume that &quot;subexp&quot; is a &quot;sub regular
expression&quot; that results if you split on the separator &quot;::&quot;.
</p>
<table>
<tr><td valign="top">A full regexp with no &quot;::&quot;:</td><td>Allow partial matches, <em>i.e.</em>, as if you wrote
<tt>/^.*#{regexp}.*$/.</tt>

</td></tr>
<tr><td valign="top">A subexp before the first &quot;::&quot;:</td><td>It behaves as <tt>/^.*#{subexp}::&#8230;/</tt>, meaning that the end of
&quot;subexp&quot; must be followed by &quot;::&quot;.

</td></tr>
<tr><td valign="top">A subexp after the last &quot;::&quot;:</td><td>It behaves as <tt>/&#8230;::#{subexp}$/</tt>, meaning that the beginning of
&quot;subexp&quot; must immediately follow a &quot;::&quot;.

</td></tr>
<tr><td valign="top">For a subexp between two &quot;::&quot;:</td><td>It behaves as <tt>/&#8230;::#{subexp}::&#8230;/</tt>, meaning that the
subexp must match the whole name between the &quot;::&quot; exactly.

</td></tr>
</table>
<p>
Note: a common idiom in aspects is to include descendents of a type, but
not the type itself. You can do as in the following example:
</p>
<pre>
  &lt;tt&gt;... :type_and_descendents =&gt; &quot;Foo&quot;, :exclude_type =&gt; &quot;Foo&quot;
</pre>
<p>
TODO: Use the new OptionsUtils.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000025-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000025-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 94</span>
 94:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find</span> <span class="ruby-identifier">options</span> = {}
 95:         <span class="ruby-identifier">result</span>   = <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Finders</span><span class="ruby-operator">::</span><span class="ruby-constant">FinderResult</span>.<span class="ruby-identifier">new</span>
 96:         <span class="ruby-identifier">excluded</span> = <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Finders</span><span class="ruby-operator">::</span><span class="ruby-constant">FinderResult</span>.<span class="ruby-identifier">new</span>
 97:         <span class="ruby-identifier">unknown_options</span> = []
 98:         <span class="ruby-identifier">input_type_nil</span> = <span class="ruby-keyword kw">false</span>
 99:         <span class="ruby-identifier">noop</span> = <span class="ruby-keyword kw">false</span>
100:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">option</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
101:           <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">TypeFinder</span>.<span class="ruby-identifier">is_recognized_option</span> <span class="ruby-identifier">option</span>
102:             <span class="ruby-identifier">unknown_options</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">option</span>
103:             <span class="ruby-keyword kw">next</span>
104:           <span class="ruby-keyword kw">end</span>
105:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
106:             <span class="ruby-identifier">input_type_nil</span> = <span class="ruby-keyword kw">true</span>
107:             <span class="ruby-keyword kw">next</span>
108:           <span class="ruby-keyword kw">end</span>
109:           <span class="ruby-identifier">noop</span> = <span class="ruby-identifier">value</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">option</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:noop</span>
110:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">noop</span>
111:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">option</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^exclude_/</span>
112:             <span class="ruby-identifier">excluded</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">find_matching</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">option</span>)
113:           <span class="ruby-keyword kw">else</span>
114:             <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">find_matching</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">option</span>)
115:           <span class="ruby-keyword kw">end</span>
116:         <span class="ruby-keyword kw">end</span>
117:         <span class="ruby-identifier">handle_errors</span> <span class="ruby-identifier">unknown_options</span>, <span class="ruby-identifier">input_type_nil</span>
118:         <span class="ruby-identifier">result</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">excluded</span>
119:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000036" class="method-detail">
        <a name="M000036"></a>

        <div class="method-heading">
          <a href="#M000036" class="method-signature">
          <span class="method-name">add_ancestors</span><span class="method-args">(types)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000036-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000036-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 226</span>
226:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_ancestors</span> <span class="ruby-identifier">types</span>
227:         <span class="ruby-identifier">types</span>.<span class="ruby-identifier">inject</span>([]) { <span class="ruby-operator">|</span><span class="ruby-identifier">memo</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">memo</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">ancestors</span> }
228:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">
          <a href="#M000035" class="method-signature">
          <span class="method-name">add_descendents</span><span class="method-args">(types)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000035-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000035-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 223</span>
223:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_descendents</span> <span class="ruby-identifier">types</span>
224:         <span class="ruby-identifier">types</span>.<span class="ruby-identifier">inject</span>([]) { <span class="ruby-operator">|</span><span class="ruby-identifier">memo</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">memo</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span><span class="ruby-operator">::</span><span class="ruby-constant">TypeUtils</span>.<span class="ruby-identifier">descendents</span>(<span class="ruby-identifier">t</span>) }
225:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000042" class="method-detail">
        <a name="M000042"></a>

        <div class="method-heading">
          <a href="#M000042" class="method-signature">
          <span class="method-name">empty</span><span class="method-args">(thing)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000042-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000042-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 251</span>
251:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty</span> <span class="ruby-identifier">thing</span>
252:         <span class="ruby-identifier">thing</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">thing</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:empty?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">thing</span>.<span class="ruby-identifier">empty?</span>)
253:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">find_by_name</span><span class="method-args">(type_name, option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
For a name (not a regular expression), return the corresponding type.
(Adapted from the RubyQuiz 113 solution by James Edward Gray II) See also
this blog: <a
href="http://blog.sidu.in/2008/02/loading-classes-from-strings-in-ruby.html">blog.sidu.in/2008/02/loading-classes-from-strings-in-ruby.html</a>
I discovered that eval works fine with JRuby wrapper classes, while
splitting on &#8217;::&#8217; and calling const_get on each module fails!
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 181</span>
181:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_by_name</span> <span class="ruby-identifier">type_name</span>, <span class="ruby-identifier">option</span>
182:         <span class="ruby-keyword kw">begin</span>
183:           <span class="ruby-identifier">found</span> = <span class="ruby-identifier">eval</span> <span class="ruby-identifier">type_name</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">binding</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-keyword kw">__LINE__</span>
184:           <span class="ruby-identifier">finish_and_make_successful_result</span> [<span class="ruby-identifier">found</span>], <span class="ruby-identifier">option</span>
185:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NameError</span> 
186:           <span class="ruby-identifier">make_failed_result</span> <span class="ruby-identifier">type_name</span>
187:         <span class="ruby-keyword kw">end</span>
188:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="#M000028" class="method-signature">
          <span class="method-name">find_matching</span><span class="method-args">(regexpes_or_names, option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 141</span>
141:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_matching</span> <span class="ruby-identifier">regexpes_or_names</span>, <span class="ruby-identifier">option</span>
142:         <span class="ruby-identifier">result</span> = <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Finders</span><span class="ruby-operator">::</span><span class="ruby-constant">FinderResult</span>.<span class="ruby-identifier">new</span>
143:         <span class="ruby-identifier">expressions</span> = <span class="ruby-identifier">make_array</span> <span class="ruby-identifier">regexpes_or_names</span>
144:         <span class="ruby-identifier">expressions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">expression</span><span class="ruby-operator">|</span>
145:           <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">strip</span> <span class="ruby-identifier">expression</span>
146:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">empty</span> <span class="ruby-identifier">expr</span>
147:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Regexp</span>
148:             <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">find_namespace_matched</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">option</span>)
149:           <span class="ruby-keyword kw">else</span>
150:             <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">option</span>)
151:           <span class="ruby-keyword kw">end</span>
152:         <span class="ruby-keyword kw">end</span>
153:         <span class="ruby-identifier">result</span>
154:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">find_namespace_matched</span><span class="method-args">(regexp, option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 156</span>
156:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_namespace_matched</span> <span class="ruby-identifier">regexp</span>, <span class="ruby-identifier">option</span>
157:         <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">regexp</span>.<span class="ruby-identifier">source</span>
158:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">empty?</span>
159:         <span class="ruby-identifier">found_types</span> = [<span class="ruby-constant">Object</span>]
160:         <span class="ruby-identifier">split_expr</span> = <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;::&quot;</span>)
161:         <span class="ruby-identifier">split_expr</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">subexp</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
162:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">subexp</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
163:           <span class="ruby-identifier">found_types</span> = <span class="ruby-identifier">find_next_types</span> <span class="ruby-identifier">found_types</span>, <span class="ruby-identifier">subexp</span>, (<span class="ruby-identifier">index</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>), (<span class="ruby-identifier">index</span> <span class="ruby-operator">==</span> (<span class="ruby-identifier">split_expr</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>))
164:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found_types</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
165:         <span class="ruby-keyword kw">end</span>
166:         <span class="ruby-comment cmt"># JRuby returns types that aren't actually defined by the enclosing namespace.</span>
167:         <span class="ruby-comment cmt"># As a sanity check, reject types whose names don't match the full regexp.</span>
168:         <span class="ruby-identifier">found_types</span>.<span class="ruby-identifier">reject!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">regexp</span>}
169:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found_types</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
170:           <span class="ruby-identifier">finish_and_make_successful_result</span> <span class="ruby-identifier">found_types</span>, <span class="ruby-identifier">option</span>
171:         <span class="ruby-keyword kw">else</span>
172:           <span class="ruby-identifier">make_failed_result</span> <span class="ruby-identifier">regexp</span>
173:         <span class="ruby-keyword kw">end</span>
174:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">find_next_types</span><span class="method-args">(enclosing_types, subexp, suppress_lh_ctrl_a, suppress_rh_ctrl_z)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 190</span>
190:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_next_types</span> <span class="ruby-identifier">enclosing_types</span>, <span class="ruby-identifier">subexp</span>, <span class="ruby-identifier">suppress_lh_ctrl_a</span>, <span class="ruby-identifier">suppress_rh_ctrl_z</span>
191:         <span class="ruby-comment cmt"># grep &lt;parent&gt;.constants because &quot;subexp&quot; may be a regexp string!.</span>
192:         <span class="ruby-comment cmt"># Then use const_get to get the type itself.</span>
193:         <span class="ruby-identifier">found_types</span> = []
194:         <span class="ruby-identifier">lhs</span> = <span class="ruby-identifier">suppress_lh_ctrl_a</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;\\A&quot;</span>
195:         <span class="ruby-identifier">rhs</span> = <span class="ruby-identifier">suppress_rh_ctrl_z</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;\\Z&quot;</span>
196:         <span class="ruby-identifier">regexp</span> = <span class="ruby-node">/#{lhs}#{subexp}#{rhs}/</span>
197:         <span class="ruby-identifier">enclosing_types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parent</span><span class="ruby-operator">|</span>
198:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:constants</span>)
199:           <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">constants</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-identifier">regexp</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> 
200:             <span class="ruby-identifier">found_types</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">name</span>)
201:           <span class="ruby-keyword kw">end</span>
202:         <span class="ruby-keyword kw">end</span>
203:         <span class="ruby-identifier">found_types</span>
204:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">finish_and_make_successful_result</span><span class="method-args">(found, option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 206</span>
206:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">finish_and_make_successful_result</span> <span class="ruby-identifier">found</span>, <span class="ruby-identifier">option</span>
207:         <span class="ruby-identifier">all</span> = <span class="ruby-identifier">prettify</span>(<span class="ruby-identifier">found</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">handle_ancestors_and_descendents</span>(<span class="ruby-identifier">found</span>, <span class="ruby-identifier">option</span>))
208:         <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">make_return_hash</span>(<span class="ruby-identifier">all</span>)
209:         <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Finders</span><span class="ruby-operator">::</span><span class="ruby-constant">FinderResult</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">hash</span>
210:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="#M000034" class="method-signature">
          <span class="method-name">handle_ancestors_and_descendents</span><span class="method-args">(types, option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 216</span>
216:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_ancestors_and_descendents</span> <span class="ruby-identifier">types</span>, <span class="ruby-identifier">option</span>
217:         <span class="ruby-identifier">result</span> = []
218:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">add_descendents</span>(<span class="ruby-identifier">types</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">should_find_descendents</span>(<span class="ruby-identifier">option</span>)
219:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">add_ancestors</span>(<span class="ruby-identifier">types</span>)   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">should_find_ancestors</span>(<span class="ruby-identifier">option</span>)
220:         <span class="ruby-identifier">result</span>
221:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="#M000026" class="method-signature">
          <span class="method-name">handle_errors</span><span class="method-args">(unknown_options, input_type_nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000026-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000026-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 124</span>
124:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_errors</span> <span class="ruby-identifier">unknown_options</span>, <span class="ruby-identifier">input_type_nil</span>
125:         <span class="ruby-identifier">message</span> = <span class="ruby-value str">&quot;&quot;</span>
126:         <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;Unknown options: #{unknown_options.inspect}. &quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">unknown_options</span>.<span class="ruby-identifier">empty?</span>
127:         <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;Input type specification can't be nil! &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">input_type_nil</span>
128:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOptions</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">message</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">empty?</span>
129:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="#M000033" class="method-signature">
          <span class="method-name">make_failed_result</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 212</span>
212:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">make_failed_result</span> <span class="ruby-identifier">name</span>
213:         <span class="ruby-constant">Aquarium</span><span class="ruby-operator">::</span><span class="ruby-constant">Finders</span><span class="ruby-operator">::</span><span class="ruby-constant">FinderResult</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:not_matched</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>([])}
214:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000039" class="method-detail">
        <a name="M000039"></a>

        <div class="method-heading">
          <a href="#M000039" class="method-signature">
          <span class="method-name">make_return_hash</span><span class="method-args">(found)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000039-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000039-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 238</span>
238:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">make_return_hash</span> <span class="ruby-identifier">found</span>
239:         <span class="ruby-identifier">prettify</span>(<span class="ruby-identifier">found</span>).<span class="ruby-identifier">inject</span>({}) {<span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, <span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>([]); <span class="ruby-identifier">hash</span>}
240:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000040" class="method-detail">
        <a name="M000040"></a>

        <div class="method-heading">
          <a href="#M000040" class="method-signature">
          <span class="method-name">prettify</span><span class="method-args">(array)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000040-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000040-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 242</span>
242:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prettify</span> <span class="ruby-identifier">array</span>
243:         <span class="ruby-identifier">array</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">inject</span>([]) {<span class="ruby-operator">|</span><span class="ruby-identifier">memo</span>, <span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">memo</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">empty</span>(<span class="ruby-identifier">x</span>); <span class="ruby-identifier">memo</span>}
244:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000038" class="method-detail">
        <a name="M000038"></a>

        <div class="method-heading">
          <a href="#M000038" class="method-signature">
          <span class="method-name">should_find_ancestors</span><span class="method-args">(option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000038-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000038-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 233</span>
233:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">should_find_ancestors</span> <span class="ruby-identifier">option</span>
234:         <span class="ruby-identifier">option</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">&quot;_ancestors&quot;</span>
235:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000037" class="method-detail">
        <a name="M000037"></a>

        <div class="method-heading">
          <a href="#M000037" class="method-signature">
          <span class="method-name">should_find_descendents</span><span class="method-args">(option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000037-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000037-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 230</span>
230:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">should_find_descendents</span> <span class="ruby-identifier">option</span>
231:         <span class="ruby-identifier">option</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">&quot;_descendents&quot;</span>
232:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000041" class="method-detail">
        <a name="M000041"></a>

        <div class="method-heading">
          <a href="#M000041" class="method-signature">
          <span class="method-name">strip</span><span class="method-args">(expression)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000041-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000041-source">
<pre>
     <span class="ruby-comment cmt"># File lib/aquarium/finders/type_finder.rb, line 246</span>
246:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">strip</span> <span class="ruby-identifier">expression</span>
247:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expression</span>.<span class="ruby-identifier">nil?</span> 
248:         <span class="ruby-identifier">expression</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:strip</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">expression</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">expression</span>
249:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>